@(
	@{ Name='Intel Graphics Control Panel'; blockExe="C:\Windows\System32\driverstore\filerepository\*\GfxDownloadWrapper.exe" },
	@{ Name='Microsoft.Workflow.Compiler';  blockExe="C:\Windows\Microsoft.NET\Framework*\*\Microsoft.Workflow.Compiler.exe" },
	@{ Name='Presentationhost'; blockExe="C:\Windows\Sys*\Presentationhost.exe" },
	@{ Name='Dfsvc';            blockExe="C:\Windows\Microsoft.NET\Framework*\*\Dfsvc.exe" },
	@{ Name='IEexec';           blockExe="C:\Windows\Microsoft.NET\Framework*\*\ieexec.exe" },
	@{ Name='Csc';              blockExe="C:\Windows\Microsoft.NET\Framework*\*\csc.exe" },
	@{ Name='Msbuild';          blockExe="C:\Windows\Microsoft.NET\Framework*\*\msbuild.exe" },
	@{ Name='Regsvcs';          blockExe="C:\Windows\Microsoft.NET\Framework*\*\regsvcs.exe" },
	@{ Name='AddinUtil';        blockExe="C:\Windows\Microsoft.NET\Framework*\*\AddinUtil.exe" },
	@{ Name='InstallUtil';      blockExe="C:\Windows\Microsoft.NET\Framework*\*\InstallUtil.exe" },
	@{ Name='aspnet_compiler';  blockExe="C:\Windows\Microsoft.NET\Framework*\*\aspnet_compiler.exe" },
	@{ Name='ngen';         blockExe="C:\Windows\Microsoft.NET\Framework*\*\ngen.exe" },
	@{ Name='HH';           blockExe=@("C:\Windows\*\hh.exe","C:\Windows\hh.exe") },	
	@{ Name='CertUtil';     blockExe="C:\Windows\Sys*\certutil.exe" },
	@{ Name='Mshta';        blockExe="C:\Windows\Sys*\mshta.exe" },
	@{ Name='BitsAdmin';    blockExe="C:\Windows\Sys*\BitsAdmin.exe" },
	@{ Name='CScript';      blockExe="C:\Windows\Sys*\cscript.exe" },
	@{ Name='WScript';      blockExe="C:\Windows\Sys*\wscript.exe" },
	@{ Name='Cmstp';        blockExe="C:\Windows\Sys*\cmstp.exe" },
	@{ Name='WmiC';         blockExe="C:\windows\*\wbem\wmic.exe" },# https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/md/Cmstp.exe.md
	@{ Name='Cmdl32';       blockExe="C:\Windows\Sys*\Cmdl32.exe" },# https://twitter.com/ElliotKillick/status/1455897435063074824?t=5m5_Y1SRhLnd_UN6YktuVQ&s=09
	@{ Name='Control';      blockExe="C:\Windows\Sys*\control.exe" },# https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/md/Control.exe.md
	@{ Name='Atbroker';     blockExe="C:\Windows\Sys*\Atbroker.exe" },
	@{ Name='Bash';         blockExe="C:\Windows\Sys*\bash.exe" },
	@{ Name='Cmdkey';       blockExe="C:\Windows\Sys*\cmdkey.exe" },
	@{ Name='Ie4uinit';     blockExe="C:\Windows\Sys*\ie4uinit.exe" },
	@{ Name='Psr';          blockExe="C:\Windows\Sys*\Psr.exe" },
	@{ Name='Pcalua';       blockExe="C:\Windows\Sys*\Pcalua.exe" },
	@{ Name='certoc';       blockExe="C:\Windows\Sys*\certoc.exe" },
	@{ Name='CertReq';      blockExe="C:\Windows\Sys*\CertReq.exe" },
	@{ Name='Regasm';       blockExe="C:\Windows\Sys*\regasm.exe" },
	@{ Name='Regsvr32';     blockExe="C:\Windows\Sys*\Regsvr32.exe" },
	@{ Name='Rundll32';     blockExe="C:\Windows\Sys*\Rundll32.exe" },
	@{ Name='Xwizard';      blockExe="C:\Windows\Sys*\xwizard.exe" },
	@{ Name='Mavinject';    blockExe="C:\Windows\Sys*\mavinject.exe" },
	@{ Name='Msdt';         blockExe="C:\Windows\Sys*\Msdt.exe" },
	@{ Name='Msiexec';      blockExe="C:\Windows\Sys*\msiexec.exe" },
	@{ Name='Odbcconf';     blockExe="C:\Windows\Sys*\odbcconf.exe" },
	@{ Name='Pcwrun';       blockExe="C:\Windows\Sys*\Pcwrun.exe" },
	@{ Name='Scriptrunner'; blockExe="C:\Windows\Sys*\Scriptrunner.exe" },
	@{ Name='SyncAppvPublishingServer';    blockExe="C:\Windows\Sys*\SyncAppvPublishingServer.exe" },
	@{ Name='Register-cimprovider';        blockExe="C:\Windows\Sys*\Register-cimprovider.exe" },
	@{ Name='InfDefaultInstall';           blockExe="C:\Windows\Sys*\InfDefaultInstall.exe" },
	@{ Name='Powershell'; blockExe=@(
		"C:\Windows\WinSxS\*_microsoft-windows-*powershell-exe_*\powershell*.exe",
		"C:\Windows\*\WindowsPowerShell\v1.0\powershell*.exe"
	) }
) | foreach {
	FWRule @{
		Name=('[Deny Internet] {0}' -f $_.Name)
		Group='LOLBAS'
		Direction='Outbound'
		Action='Block'
		blockExe=$_.blockExe
		RemoteAddress=$IPForInternet
	}
}