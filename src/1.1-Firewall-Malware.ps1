#	blockExe "Windows Defender" "C:\ProgramData\Microsoft\Windows Defender\platform\*\MpCmdRun.exe",# Fixed in the latest version of Defender
#	https://malware.news/t/a-deep-dive-into-rundll32-exe/43840
#	blockExe "Rundll32" "C:\Windows\System32\rundll32.exe",

@(
	@{ Name='Intel Graphics Control Panel'; blockExe="C:\Windows\System32\driverstore\filerepository\*\GfxDownloadWrapper.exe" },
	@{ Name='Presentationhost'; blockExe="C:\Windows\Sys*\Presentationhost.exe" },
	@{ Name='Dfsvc'; blockExe="C:\Windows\Microsoft.NET\*\*\Dfsvc.exe" },
	@{ Name='IEexec'; blockExe="C:\Windows\Microsoft.NET\*\*\ieexec.exe" },
	@{ Name='HH'; blockExe=@("C:\Windows\*\hh.exe","C:\Windows\hh.exe") },
	@{ Name='CertUtil'; blockExe="C:\Windows\System32\certutil.exe" },
	@{ Name='Mshta'; blockExe="C:\Windows\System32\mshta.exe" },
	@{ Name='BitsAdmin'; blockExe="C:\Windows\System32\BitsAdmin.exe" },
	@{ Name='CScript'; blockExe="C:\Windows\System32\cscript.exe" },
	@{ Name='WScript'; blockExe="C:\Windows\System32\wscript.exe" },
	@{ Name='Cmdl32'; blockExe="C:\Windows\System32\Cmdl32.exe" },# https://twitter.com/ElliotKillick/status/1455897435063074824?t=5m5_Y1SRhLnd_UN6YktuVQ&s=09
	@{ Name='Powershell'; blockExe=@(
		"C:\Windows\WinSxS\*\powershell.exe",
		"C:\Windows\WinSxS\*\PowerShell_ISE.exe",
		"C:\Windows\*\WindowsPowerShell\v1.0\powershell.exe",
		"C:\Windows\*\WindowsPowerShell\v1.0\PowerShell_ISE.exe"
	) }
) | foreach {
	FWRule @{
		Name=('[Deny Internet] {0}' -f $_.Name)
		Group='LOLBAS'
		Direction='Outbound'
		Action='Block'
		blockExe=$_.blockExe
		RemoteAddress=$IPForInternet
	}
}
